function setBannerFadeoutTimer(e){hideBannerTimer=setTimeout(function(){e.fadeOut(function(){$(this).removeClass("show")})},6e3)}function showBannerMessage(e,t,n,a){clearTimeout(hideBannerTimer);var i=t.find(".error-text");i.fadeOut(function(){i.text(e).fadeIn(function(){"function"==typeof n&&n()}),a?i.addClass("success"):i.removeClass("success"),setBannerFadeoutTimer(i)})}function getQSParameterByName(e){var t=window.location.href;e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),a=n.exec(t);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null}var hideBannerTimer,mySkiftPath="https://my.skift.com/",host=document.location.host;host.indexOf("localhost")>-1&&(mySkiftPath="http://localhost/myskift/"),host.indexOf(".wpengine.com")>-1&&(mySkiftPath="https://myskift.wpengine.com/"),(host.indexOf("myskift.wpengine.com")>-1||host.indexOf("my.skift.com")>-1)&&(mySkiftPath="/");var mySkiftAjaxPath=mySkiftPath+"ajax/";$(".error-text").is(":visible")&&setBannerFadeoutTimer($(".error-text")),$(function(){var e,t,n=function(t){if(JSON.stringify(e)!==JSON.stringify(t)){e=t,$cart=$(".shopping-cart .cart-contents"),$cart.find(".spinner").hide(),$cart.find(".cart-item:not(.template)").remove(),$(".shopping-cart .total-price").html(t.pricing.discounted_total_price),$(".shopping-cart .pre-total-price").html(t.pricing.total_price),$(".shopping-cart .discount").html(t.pricing.discount);var n=t.items;$(".shopping-cart .badge").html(n.length),n.length>0?($cart.find(".no-items").fadeOut("fast"),$(".shopping-cart .badge").show()):($cart.find(".no-items").fadeIn("fast"),$(".shopping-cart .badge").hide());for(var a=0;a<n.length;a++){var i=n[a];$($(".shopping-cart .cart-contents.popover .cart-item.template").clone()).find(".photo img").attr("src",i.image).end().find(".item-name h3").html(i.title).end().find(".item-price span").html(i.price).end().find(".remove-from-cart-btn").data("index",i.index).end().insertBefore($cart.find(".items .cart-item.template")).removeClass("template").fadeIn()}}},a=function(){clearTimeout(t);var e=Math.random();$.ajax({url:mySkiftAjaxPath+"get-cart-contents.php",method:"POST",data:{rand:e},dataType:"json",xhrFields:{withCredentials:!0},error:function(e){console.error("error getting cart contents",e)},success:n})};a(),$(document).on("click",".add-to-cart-btn",function(){var e=$(this),a=e.data("contentid"),i=e.data("resourceid"),o=e.data("type");"undefined"!=typeof o&&""!==o||(o="content");var s={contentId:a,resourceId:i,type:o};e.html("<i class='fa fa-cog fa-spin'></i> Adding to Cart").addClass("disabled in-cart-btn").removeClass("add-to-cart-btn"),clearTimeout(t),$.ajax({url:mySkiftAjaxPath+"add-to-cart.php",method:"POST",data:s,dataType:"json",xhrFields:{withCredentials:!0},error:function(t){e.html("error"),console.error("Error adding to cart",t)},success:function(a){console.log("add to cart response",a),e.html("<i class='fa fa-check'></i> In Cart");var i=a.cartContents;n(i),$(".sign-in").hasClass("isOpen")&&$(".sign-in").removeClass("isOpen"),$(".shopping-cart").addClass("isOpen"),t=setTimeout(function(){$(".shopping-cart").removeClass("isOpen")},3e3)}})}),$(document).on("click",".remove-from-cart-btn",function(){var e=$(this),t=e.closest(".cart-item"),n=t.closest(".cart-items"),i=e.data("index");e.html('<i class="fa fa-cog fa-spin"></i> Remove'),e.prop("disabled",!0),$.ajax({url:mySkiftAjaxPath+"remove-from-cart.php",method:"POST",data:{index:i},dataType:"json",xhrFields:{withCredentials:!0},error:function(t){e.html("error")},complete:function(i){e.html('<i class="fa fa-trash"></i> Remove'),t.fadeOut(function(){$(this).remove(),n.find(".cart-item").length||(n.fadeOut(),$(".shopping-cart-page .totals-area").fadeOut(function(){$(".shopping-cart-page .no-items").fadeIn()}))}),a()}})}),$(".cart-btn").click(function(){$(".sign-in").hasClass("isOpen")&&$(".sign-in").removeClass("isOpen"),a(),$(".shopping-cart").toggleClass("isOpen")})}),$(function(){$(".mobile-account-manager .top").click(function(e){$(".mobile-account-manager").toggleClass("open"),e.stopPropagation()}),$("body").click(function(){$(".mobile-acount-manager").hasClass("open")&&$(".mobile-acount-manager").removeClass("open")})}),$(function(){if($("#header-sign-in-with-popover").length){var e=function(){var e=$("#header-sign-in-with-popover"),t=e.find(".error-text");t.fadeOut(function(){e.find(".form-group").removeClass("has-error")})};$("body").keyup(function(t){27===t.keyCode&&$(".sign-in").hasClass("isOpen")&&($(".sign-in").removeClass("isOpen"),e())}),$(".sign-in-btn").click(function(){$(".shopping-cart").hasClass("isOpen")&&$(".shopping-cart").removeClass("isOpen"),$(".sign-in").toggleClass("isOpen"),e(),$("#sign-in-popover input").each(function(){""!==$(this).val()&&$(this).parent().addClass("has-text")})}),$("#my-account-menu li:first-child a").hover(function(){$("#sign-in-popover").addClass("green-arrow")},function(){$("#sign-in-popover").removeClass("green-arrow")}),$("#header-sign-in-with-popover .overlay").click(function(){$(".sign-in, .shopping-cart").removeClass("isOpen"),e()}),$(".sign-in").click(function(e){e.stopPropagation()}),$(".has-floating-label").on("change keyup blur input",function(){""!==$(this).val()?$(this).parent().addClass("has-text"):$(this).parent().removeClass("has-text")})}$(".login-btn").click(function(e){var t=$(this).closest(".login-form"),n=!0;t.find("input").each(function(){""===$(this).val()&&(n=!1)});var a=80,i=15,o=function(e,t){e.css("position","relative"),e.animate({left:"-"+i+"px"},a,function(){e.animate({left:i+"px"},a,function(){0===t?e.animate({left:0},a):o(e,--t)})})};if(n){$(this).html('<i class="fa fa-cog fa-spin"></i> Sign In'),t.find("input,button").attr("disabled",!0);var s={login_email:t.find(".username-field").val(),login_password:t.find(".password-field").val()};$.ajax({url:mySkiftAjaxPath+"login.php",method:"POST",dataType:"json",data:s,xhrFields:{withCredentials:!0},error:function(e){showBannerMessage("An uexpected error occured.",t)},success:function(e){t.find("button").html("Sign In"),t.find("input,button").attr("disabled",!1),e.success?showBannerMessage("You are now logged in",t,function(){var e=t.find(".login-redirect").val();if(e&&""!==e)location.href=e;else if(t.hasClass("reload")){var n=location.pathname;n.indexOf("/login")>-1?location.href=mySkiftPath:location.reload()}else location.href=mySkiftPath},!0):(showBannerMessage(e.errorMessage,t),o(t,1))}})}else showBannerMessage("Please enter both your email address and password.",t);return e.preventDefault(),!1})});